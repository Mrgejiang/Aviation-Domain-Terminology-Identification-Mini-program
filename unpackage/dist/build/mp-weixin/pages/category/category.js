"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("PageSkeleton")+e.resolveComponent("uni-easyinput"))()}Math||((()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+a)();const a=()=>"./components/PreviewList.js",n=e.defineComponent({__name:"category",setup(a){const n=e.er.database(),o=e.ref(null),l=()=>{var e;null==(e=o.value)||e.getMore()},t=e.ref([]),r=e.ref(0),u=e.computed((()=>{var e;return(null==(e=t.value[r.value])?void 0:e.name)||"名称"})),i=e.computed((()=>{var e;return(null==(e=t.value[r.value])?void 0:e._id)||"0"})),s=e.ref(!1),v=async()=>{var e;s.value=!0,await(null==(e=o.value)?void 0:e.resetData()),s.value=!1},c=e.ref(""),d=()=>{if(""===c.value)return e.index.showToast({title:"请输入搜索内容",icon:"none"});e.index.navigateTo({url:`/pages/search/search?content=${c.value}`})},g=e.ref(!0),f=e.ref("");e.onLoad((async()=>{if(f.value=e.index.getStorageSync("curCategory"),await(async()=>{const e=n.collection("opendb-news-categories"),a=await e.field("_id,name").get();t.value=a.result.data,console.log("获取分类数据",t.value)})(),t.value=e.index.getStorageSync("categoryList")._value,console.log("定位分类",f.value),""!==f.value){const e=t.value.findIndex((e=>e._id===f.value));-1!==e&&(r.value=e)}g.value=!1})),e.onShow((()=>{const a=e.index.getStorageSync("curCategory");if(a){const e=t.value.findIndex((e=>e._id===a));-1!==e&&(r.value=e)}}));const m={color:"#333",borderColor:"#111",backgroundColor:"rgba(255, 255, 255, 0.5)",disableColor:"#f7f6f6"};return(a,n)=>e.e({a:g.value},g.value?{}:{b:e.o(d),c:e.o(d),d:e.o((e=>c.value=e)),e:e.p({styles:m,trim:"both",prefixIcon:"search",clearable:!0,type:"text",placeholder:"搜索术语",confirmType:"search",modelValue:c.value}),f:e.f(t.value,((a,n,o)=>({a:e.t(a.name.length<=4?a.name:a.name.substring(0,3)+"..."),b:a._id,c:n===r.value?1:"",d:e.o((o=>((a,n)=>{r.value=a,e.index.setStorage({key:"curCategory",data:n})})(n,a._id)),a._id)}))),g:e.sr(o,"b37b673e-2",{k:"PreviewRef"}),h:i.value,i:e.p({name:u.value,id:i.value}),j:e.o(l),k:e.o(v),l:s.value})}});wx.createPage(n);
