{"version":3,"file":"index.js","sources":["pages/index/index.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\n\t<!-- 自定义导航栏 -->\n\t<CustomNavbar />\n\t<!-- 滚动容器：触底加载 -->\n\t<scroll-view enable-back-to-top refresher-enabled class=\"scroll-view\" scroll-y @scrolltolower=\"onScrolltolower\"\n\t\t@refresherrefresh=\"onRefresherrefresh\" :refresher-triggered=\"isLriggered\">\n\t\t<PageSkeleton v-if=\"isLoading\" />\n\t\t<template v-else>\n\t\t\t<!-- 轮播图 :传递数据 -->\n\t\t\t<TopSwiper :list=\"noticesList\" />\n\t\t\t<!-- 分类 ：传递数据 -->\n\t\t\t<CategoryPanel :list=\"categoryList\" />\n\t\t\t<!-- 推荐：预览列表 -->\n\t\t\t<PreviewList ref=\"PreviewRef\" />\n\t\t</template>\n\t</scroll-view>\n</template>\n\n<script setup lang=\"ts\">\n\timport { NoticeItem } from \"../../types/notice\";\n\timport { CategoryItem } from \"../../types/category\"\n\timport CustomNavbar from \"./components/CustomNavbar.vue\"\n\timport TopSwiper from \"./components/TopSwiper.vue\"\n\timport CategoryPanel from \"./components/CategoryPanel.vue\"\n\timport PreviewList from \"./components/PreviewList.vue\";\n\timport { onLoad } from '@dcloudio/uni-app'\n\timport { ref } from \"vue\";\n\n\t//\n\tconst PreviewRef = ref(null)\n\n\t//数据库\n\tconst db = uniCloud.database();\n\n\t//首页公告数据\n\tconst noticesList : NoticeItem[] = [\n\t\t{ _id: '1', imgUrl: 'https://mp-003d93a9-efde-40df-a943-25e82e419019.cdn.bspapp.com/images/notice1.png' },\n\t\t{ _id: '2', imgUrl: 'https://mp-003d93a9-efde-40df-a943-25e82e419019.cdn.bspapp.com/images/notice2.png' },\n\t]\n\n\t//首页分类数据\n\tconst categoryList = ref<CategoryItem[]>([])\n\tconst getCategoryData = async () => {\n\t\tconst categoryTable = db.collection('opendb-news-categories')\n\t\tconst res = await categoryTable.field(\"_id,name,icon\").get()\n\t\tcategoryList.value = res.result.data\n\t\t// uni.__f__('log','at pages/index/index.vue:47',\"获取分类数据\", categoryList.value)\n\t\tuni.setStorage({\n\t\t\tkey: 'categoryList',\n\t\t\tdata: categoryList\n\t\t}).then(() => {\n\t\t\tuni.__f__('log','at pages/index/index.vue:52',\"获取并存储分类数据\", uni.getStorageSync('categoryList')._value);\n\t\t})\n\t}\n\n\t//页面加载中\n\tconst isLoading = ref(true)\n\n\t//页面初始加载\n\tonLoad(async () => {\n\t\tisLoading.value = true\n\t\t//请求数据\n\t\tgetCategoryData()\n\t\t\t.catch(() => {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: \"网络错误\",\n\t\t\t\t\ticon: \"error\"\n\t\t\t\t})\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tisLoading.value = false\n\t\t\t})\n\t})\n\n\t//触底加载\n\tconst onScrolltolower = () => {\n\t\tPreviewRef.value?.getMore()\n\t}\n\n\t//自定义下拉刷新状态\n\tconst isLriggered = ref(false)\n\t// 自定义下拉刷新被触发\n\tconst onRefresherrefresh = async () => {\n\t\t//开始动画\n\t\tisLriggered.value = true\n\t\t//先重置预览列表数据\n\n\t\t// 重新请求-公告和分类数据-网络请求需要await\n\t\tawait Promise.all([getCategoryData(), PreviewRef.value?.resetData()])\n\t\t//结束动画\n\t\tisLriggered.value = false\n\t}\n</script>\n\n<style lang=\"scss\">\n\tpage {\n\t\tbackground-color: #f7f7f7;\n\t\theight: 100%;\n\t\toverflow: hidden;\n\t}\n\n\t.scroll-view {\n\t\tflex: 1;\n\t\toverflow: hidden;\n\t\tpadding-bottom: 100px;\n\t}\n</style>","import MiniProgramPage from 'E:/桌面/创新培育/kite-master/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uniCloud","uni","onLoad","MiniProgramPage"],"mappings":";;;;;;;;;AAqBC,MAAA,eAAyB,MAAA;AACzB,MAAA,YAAsB,MAAA;AACtB,MAAA,gBAA0B,MAAA;AAC1B,MAAA,cAAwB,MAAA;;;;AAKlB,UAAA,aAAaA,kBAAI,IAAI;AAGrB,UAAA,KAAKC,iBAAS;AAGpB,UAAM,cAA6B;AAAA,MAClC,EAAE,KAAK,KAAK,QAAQ,oFAAoF;AAAA,MACxG,EAAE,KAAK,KAAK,QAAQ,oFAAoF;AAAA,IAAA;AAInG,UAAA,eAAeD,kBAAoB,CAAA,CAAE;AAC3C,UAAM,kBAAkB,YAAY;AAC7B,YAAA,gBAAgB,GAAG,WAAW,wBAAwB;AAC5D,YAAM,MAAM,MAAM,cAAc,MAAM,eAAe,EAAE;AAC1C,mBAAA,QAAQ,IAAI,OAAO;AAEhCE,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,QACL,MAAM;AAAA,MAAA,CACN,EAAE,KAAK,MAAM;AACTA,4BAAA,MAAM,OAAM,+BAA8B,aAAaA,oBAAI,eAAe,cAAc,EAAE,MAAM;AAAA,MAAA,CACpG;AAAA,IAAA;AAII,UAAA,YAAYF,kBAAI,IAAI;AAG1BG,kBAAAA,OAAO,YAAY;AAClB,gBAAU,QAAQ;AAEF,sBAAA,EACd,MAAM,MAAM;AACZD,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACN;AAAA,MAAA,CACD,EACA,QAAQ,MAAM;AACd,kBAAU,QAAQ;AAAA,MAAA,CAClB;AAAA,IAAA,CACF;AAGD,UAAM,kBAAkB,MAAM;;AAC7B,uBAAW,UAAX,mBAAkB;AAAA,IAAQ;AAIrB,UAAA,cAAcF,kBAAI,KAAK;AAE7B,UAAM,qBAAqB,YAAY;;AAEtC,kBAAY,QAAQ;AAId,YAAA,QAAQ,IAAI,CAAC,gBAAA,IAAmB,gBAAW,UAAX,mBAAkB,WAAW,CAAC;AAEpE,kBAAY,QAAQ;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;ACzFtB,GAAG,WAAWI,SAAe;"}