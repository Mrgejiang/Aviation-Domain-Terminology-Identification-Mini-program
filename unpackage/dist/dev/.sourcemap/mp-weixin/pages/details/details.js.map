{"version":3,"file":"details.js","sources":["pages/details/details.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGV0YWlscy9kZXRhaWxzLnZ1ZQ"],"sourcesContent":["<template>\n\t<PageSkeleton v-if=\"isLoading\" />\n\t<view class=\"details\" v-else>\n\t\t<video class=\"detailsVedio\" controls :src=\"termDetailsData?.video\" :poster=\"termDetailsData?.poster\"\n\t\t\tshow-mute-btn :title=\"termDetailsData?.cnDetails.name\" enable-play-gesture @error=\"onVideoError\"></video>\n\t\t<view class=\"tips\">\n\t\t\t<text class=\"tipsText\">双击可以播放或暂停哦</text>\n\t\t\t<text class=\"selection icon-heart-ed\" v-if=\"isSelected\" @tap=\"onTapSelection\"></text>\n\t\t\t<text class=\"selection icon-heart\" v-else @tap=\"onTapSelection\"></text>\n\t\t</view>\n\t\t<scroll-view enable-back-to-top scroll-y>\n\t\t\t<view class=\"viewItem\" v-for=\"(item,index) in [\n          termDetailsData?.cnDetails,\n          termDetailsData?.usDetails,\n          termDetailsData?.euDetails,\n        ]\" :key=\"index\">\n\t\t\t\t<view class=\"title1\">\n\t\t\t\t\t<text>{{ index===0?'中':(index===1?'美':'欧') }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view>\n\t\t\t\t\t<view class=\"title2\">●名称</view>\n\t\t\t\t\t<text class=\"content\" user-select>{{ item?.name }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view v-if=\"index === 0\">\n\t\t\t\t\t<view class=\"title2\">●英文</view>\n\t\t\t\t\t<text class=\"content\" user-select>{{ termDetailsData?.cnDetails.en }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view>\n\t\t\t\t\t<view class=\"title2\">●缩写</view>\n\t\t\t\t\t<text class=\"content\" user-select>{{ item?.abbr }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view>\n\t\t\t\t\t<view class=\"title2\">●分类</view>\n\t\t\t\t\t<text class=\"content\" user-select>{{ item.category_id[0]?.name||'未分类' }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view>\n\t\t\t\t\t<view class=\"title2\">●定义</view>\n\t\t\t\t\t<text class=\"content\" user-select>{{ item?.define }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view>\n\t\t\t\t\t<view class=\"title2\">●来源</view>\n\t\t\t\t\t<text class=\"content\" user-select>{{ item?.source }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view>\n\t\t\t\t\t<view class=\"title2\">●扩展</view>\n\t\t\t\t\t<text class=\"content\" user-select>{{ item?.expand }}</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view class=\"viewItem\">\n\t\t\t\t<view class=\"title1\">对比分析</view>\n\t\t\t\t<text class=\"content\" style=\"text-indent: 0em;\" user-select>{{ termDetailsData?.compareResult }}</text>\n\t\t\t</view>\n\t\t</scroll-view>\n\t</view>\n</template>\n\n<script setup lang=\"ts\">\n\timport { ref } from 'vue';\n\timport { onLoad } from '@dcloudio/uni-app'\n\timport { store } from '@/uni_modules/uni-id-pages/common/store.js'\n\timport { termDetails } from '../../types/details'\n\n\tconst db = uniCloud.database();\n\tconst favoriteTable = db.collection('opendb-news-favorite')\n\tconst logTable = db.collection('read-news-log')\n\n\t//播放视频出错\n\tconst onVideoError = (ev) => {\n\t\tuni.showToast({\n\t\t\ttitle: '视频走丢了!',\n\t\t\ticon: 'none',\n\t\t})\n\t}\n\n\t//获取词条详细数据\n\tconst termDetailsData = ref<termDetails>()\n\tconst getTermDetailsData = async () => {\n\t\tconst category = db.collection('opendb-news-categories').field('_id,name').getTemp()\n\t\tconst res = await db.collection('opendb-news-articles', category).where('_id==\"' + id.value + '\"').get()\n\t\ttermDetailsData.value = res.result.data[0]\n\t\tuni.__f__('log','at pages/details/details.vue:81',\"获取词条详细数据\", termDetailsData.value);\n\t\tsetReadNewsLog()\n\t}\n\n\t//正在加载\n\tconst isLoading = ref(true)\n\tconst id = ref('')\n\tonLoad(async (op) => {\n\t\tisLoading.value = true\n\t\tuni.__f__('log','at pages/details/details.vue:90','详情_id', op.id);\n\t\tid.value = op.id\n\t\tawait getTermDetailsData()\n\t\tuni.setNavigationBarTitle({\n\t\t\ttitle: `词条: ${termDetailsData.value.cnDetails.name || termDetailsData.value.usDetails.name || termDetailsData.value.euDetails.name}`,\n\t\t})\n\t\tif (store.hasLogin) {\n\t\t\t//如果已登录，获取用户收藏状态\n\t\t\tconst res = await favoriteTable.where(`\"article_id\" == \"${id.value}\" && \"user_id\"==$env.uid`).get()\n\t\t\tif (res.result.data.length > 0) {\n\t\t\t\tisSelected.value = true\n\t\t\t\tselectId = res.result.data[0]._id\n\t\t\t}\n\t\t}\n\t\tisLoading.value = false\n\t})\n\n\t//收藏\n\tconst isSelected = ref(false)\n\tlet selectId = ''\n\tconst onTapSelection = async () => {\n\t\tif (!store.hasLogin) {\n\t\t\t//如果未登录，提示登录\n\t\t\treturn uni.showModal({\n\t\t\t\tcontent: '是否现在登录？',\n\t\t\t\tconfirmColor: '#6cb8f3',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\turl: '/uni_modules/uni-id-pages/pages/login/login-withoutpwd',\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t})\n\t\t}\n\t\tif (isSelected.value) {\n\t\t\t//取消收藏\n\t\t\tfavoriteTable\n\t\t\t\t.doc(selectId)\n\t\t\t\t.remove()\n\t\t\t\t.then((res) => {\n\t\t\t\t\tuni.__f__('log','at pages/details/details.vue:131','取消收藏', res)\n\t\t\t\t\tselectId = ''\n\t\t\t\t\tisSelected.value = false\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tuni.__f__('log','at pages/details/details.vue:136',err);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '出错了!',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t} else {\n\t\t\t//收藏\n\t\t\tfavoriteTable\n\t\t\t\t.add({\n\t\t\t\t\t\"article_id\": id.value\n\t\t\t\t})\n\t\t\t\t.then((res) => {\n\t\t\t\t\tuni.__f__('log','at pages/details/details.vue:149','收藏', res)\n\t\t\t\t\tselectId = res.result.id\n\t\t\t\t\tisSelected.value = true\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tuni.__f__('log','at pages/details/details.vue:154',err);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '出错了!',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t}\n\t}\n\n\t//本地历史\n\tconst setReadNewsLog = () => {\n\t\tlet item = {\n\t\t\t\"article_id\": id.value,\n\t\t\t\"last_time\": Date.now()\n\t\t},\n\t\t\treadNewsLog = uni.getStorageSync('readNewsLog') || [],\n\t\t\tindex = -1;\n\t\treadNewsLog.forEach(({ article_id }, i) => {\n\t\t\tif (article_id == item.article_id) {\n\t\t\t\tindex = i\n\t\t\t}\n\t\t})\n\t\tif (index === -1) {\n\t\t\treadNewsLog.push(item)\n\t\t} else {\n\t\t\treadNewsLog.splice(index, 1, item)\n\t\t}\n\t\tuni.setStorageSync('readNewsLog', readNewsLog)\n\t\tuni.__f__('log','at pages/details/details.vue:182','本地历史记录', readNewsLog);\n\t}\n</script>\n\n\n<style scoped>\n\t.details {\n\t\tmax-width: 95%;\n\t\tmargin: 0 auto;\n\t\tpadding: 10px;\n\t\tfont-family: Arial, sans-serif;\n\t}\n\n\t.detailsVedio {\n\t\twidth: 100%;\n\t\tborder-radius: 10px;\n\t\toverflow: hidden;\n\t\theight: 220px;\n\t\tbackground-color: #000;\n\t\tmargin-bottom: 4px;\n\t}\n\n\t.tips {\n\t\theight: 12px;\n\t\tdisplay: flex;\n\t\tmargin: 0 0 12px 0;\n\t}\n\n\t.tipsText {\n\t\tfont-size: 12px;\n\t\ttext-align: center;\n\t\twidth: 100%;\n\t\tcolor: #726f6f;\n\t}\n\n\t.selection {\n\t\tdisplay: block;\n\t\tfont-size: 21px;\n\t\tcolor: #ff9545;\n\t\tmargin-right: 5px;\n\t}\n\n\t.viewItem {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tpadding: 10px;\n\t\tborder: 1px solid #ddd;\n\t\tborder-radius: 5px;\n\t\tbackground-color: #fff;\n\t\tmargin-bottom: 10px;\n\t}\n\n\t.title2 {\n\t\tfont-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;\n\t\t/* 使用Helvetica字体族，优雅且通用 */\n\t\tfont-size: 16px;\n\t\t/* 字体大小适中，适合作为二级标题 */\n\t\tfont-weight: 650;\n\t\t/* 字体稍粗，但不过于显眼 */\n\t\tcolor: #000000;\n\t\t/* 字体颜色为黑色，清晰易读 */\n\t\ttext-align: left;\n\t\t/* 文本左对齐，符合阅读习惯 */\n\t\tmargin-top: 20px;\n\t\t/* 适当的上边距，与上方内容分隔 */\n\t\tmargin-bottom: 10px;\n\t\t/* 较小的下边距，紧凑布局 */\n\t\tletter-spacing: 0.5px;\n\t\t/* 轻微的字母间距调整，增加美观度 */\n\t}\n\n\t.title1 {\n\t\tfont-family: Arial, sans-serif;\n\t\t/* 使用 Arial 字体，如果找不到则使用无衬线字体 */\n\t\tfont-size: 22px;\n\t\t/* 字体大小为 24 像素 */\n\t\tfont-weight: bold;\n\t\t/* 字体加粗 */\n\t\tcolor: #333333;\n\t\t/* 字体颜色为深灰色 */\n\t\ttext-align: center;\n\t\t/* 文本居中对齐 */\n\t\tmargin-top: 30px;\n\t\t/* 上边距为 40 像素 */\n\t\tmargin-bottom: 10px;\n\t\t/* 下边距为 20 像素 */\n\t\ttext-transform: uppercase;\n\t\t/* 文本转换为大写 */\n\t\tletter-spacing: 2px;\n\t\t/* 字母间距为 2 像素 */\n\t\tposition: relative;\n\t\t/* 定位为相对定位 */\n\t}\n\n\t.title1::before {\n\t\tcontent: '';\n\t\t/* 伪元素内容为空 */\n\t\tposition: absolute;\n\t\t/* 定位为绝对定位 */\n\t\twidth: 90%;\n\t\t/* 宽度为 50 像素 */\n\t\theight: 2px;\n\t\t/* 高度为 2 像素 */\n\t\tbackground-color: #333333;\n\t\t/* 背景颜色为深灰色 */\n\t\tleft: 50%;\n\t\t/* 左边距为父元素的 50% */\n\t\ttop: -20px;\n\t\t/* 上边距为负 20 像素，即向上移动 20 像素 */\n\t\ttransform: translateX(-50%);\n\t\t/* 水平位移，使元素居中 */\n\t}\n\n\t.title1::after {\n\t\tcontent: '';\n\t\t/* 伪元素内容为空 */\n\t\tposition: absolute;\n\t\t/* 定位为绝对定位 */\n\t\twidth: 30px;\n\t\t/* 宽度为 30 像素 */\n\t\theight: 2px;\n\t\t/* 高度为 2 像素 */\n\t\tbackground-color: #333333;\n\t\t/* 背景颜色为深灰色 */\n\t\tleft: 50%;\n\t\t/* 左边距为父元素的 50% */\n\t\tbottom: -10px;\n\t\t/* 下边距为负 10 像素，即向下移动 10 像素 */\n\t\ttransform: translateX(-50%);\n\t\t/* 水平位移，使元素居中 */\n\t}\n\n\t.content {\n\t\tfont-family: 'Helvetica Neue', Helvetica, Arial, 'Microsoft YaHei', 'WenQuanYi Micro Hei',\n\t\t\tsans-serif;\n\t\t/* 中西文字体设置 */\n\t\tfont-size: 14px;\n\t\t/* 正文字体大小 */\n\t\tline-height: 1.6;\n\t\t/* 行高，影响阅读舒适度 */\n\t\tcolor: #333;\n\t\t/* 字体颜色 */\n\t\ttext-align: justify;\n\t\t/* 文本两端对齐，仅适用于西文排版，中文通常不开启 */\n\t\tmargin-bottom: 20px;\n\t\t/* 正文与下一个元素之间的间距 */\n\t\ttext-indent: 2em;\n\t\t/* 首行缩进两个字符宽度，适用于中文排版 */\n\t}\n</style>","import MiniProgramPage from 'E:/桌面/创新培育/kite-master/pages/details/details.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","uni","ref","onLoad","store"],"mappings":"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"}