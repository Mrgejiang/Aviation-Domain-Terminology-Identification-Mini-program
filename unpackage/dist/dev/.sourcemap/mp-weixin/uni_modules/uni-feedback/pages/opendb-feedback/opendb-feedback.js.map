{"version":3,"file":"opendb-feedback.js","sources":["uni_modules/uni-feedback/pages/opendb-feedback/opendb-feedback.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/dW5pX21vZHVsZXNcdW5pLWZlZWRiYWNrXHBhZ2VzXG9wZW5kYi1mZWVkYmFja1xvcGVuZGItZmVlZGJhY2sudnVl"],"sourcesContent":["<template>\n\t<view class=\"uni-container\">\n\t\t<uni-forms ref=\"form\" :value=\"formData\" validate-trigger=\"submit\" err-show-type=\"toast\">\n\t\t\t<uni-forms-item name=\"content\" label=\"留言内容/回复内容\" required>\n\t\t\t\t<textarea @input=\"binddata('content', $event.detail.value)\" class=\"uni-textarea-border\"\n\t\t\t\t\tv-model=\"formData.content\" trim=\"right\"></textarea>\n\t\t\t</uni-forms-item>\n\t\t\t<uni-forms-item name=\"imgs\" label=\"图片列表\">\n\t\t\t\t<uni-file-picker file-mediatype=\"image\" :limit=\"6\" return-type=\"array\" v-model=\"formData.imgs\">\n\t\t\t\t</uni-file-picker>\n\t\t\t</uni-forms-item>\n\t\t\t<uni-forms-item name=\"contact\" label=\"联系人\">\n\t\t\t\t<uni-easyinput v-model=\"formData.contact\" trim=\"both\"></uni-easyinput>\n\t\t\t</uni-forms-item>\n\t\t\t<uni-forms-item name=\"mobile\" label=\"联系电话\">\n\t\t\t\t<uni-easyinput v-model=\"formData.mobile\" trim=\"both\"></uni-easyinput>\n\t\t\t</uni-forms-item>\n\t\t\t<view class=\"uni-button-group\">\n\t\t\t\t<button type=\"primary\" class=\"uni-button\" @click=\"submit\">提交</button>\n\t\t\t</view>\n\t\t</uni-forms>\n\t</view>\n</template>\n\n<script>\n\timport {\n\t\tvalidator\n\t} from '../../js_sdk/validator/opendb-feedback.js';\n\tconsole.log(validator);\n\tconst db = uniCloud.database();\n\tconst dbCollectionName = 'opendb-feedback';\n\n\tfunction getValidator(fields) {\n\t\tlet result = {}\n\t\tfor (let key in validator) {\n\t\t\tif (fields.indexOf(key) > -1) {\n\t\t\t\tresult[key] = validator[key]\n\t\t\t}\n\t\t}\n\t\treturn result\n\t}\n\n\texport default {\n\t\tdata() {\n\t\t\tlet formData = {\n\t\t\t\t\"content\": \"\",\n\t\t\t\t\"imgs\": [],\n\t\t\t\t\"contact\": \"\",\n\t\t\t\t\"mobile\": \"\"\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tformData,\n\t\t\t\tformOptions: {},\n\t\t\t\trules: {\n\t\t\t\t\t...getValidator(Object.keys(formData))\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonReady() {\n\t\t\tthis.$refs.form.setRules(this.rules)\n\t\t},\n\t\tmethods: {\n\t\t\t/**\n\t\t\t * 触发表单提交\n\t\t\t */\n\t\t\tsubmit() {\n\t\t\t\tuni.showLoading({\n\t\t\t\t\tmask: true\n\t\t\t\t})\n\t\t\t\tthis.$refs.form.validate().then((res) => {\n\t\t\t\t\tthis.submitForm(res)\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t})\n\t\t\t},\n\n\t\t\tsubmitForm(value) {\n\t\t\t\t// 使用 clientDB 提交数据\n\t\t\t\tdb.collection(dbCollectionName).add(value).then((res) => {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\ttitle: '提交成功'\n\t\t\t\t\t})\n\t\t\t\t\tthis.getOpenerEventChannel().emit('refreshData')\n\t\t\t\t\tsetTimeout(() => uni.navigateBack(), 500)\n\t\t\t\t}).catch((err) => {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\tcontent: err.message || '请求服务失败',\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t})\n\t\t\t\t}).finally(() => {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t.uni-container {\n\t\tpadding: 15px;\n\t}\n\n\t.uni-input-border,\n\t.uni-textarea-border {\n\t\twidth: 100%;\n\t\tfont-size: 14px;\n\t\tcolor: #666;\n\t\tborder: 1px #e5e5e5 solid;\n\t\tborder-radius: 5px;\n\t\tbox-sizing: border-box;\n\t}\n\n\t.uni-input-border {\n\t\tpadding: 0 10px;\n\t\theight: 35px;\n\n\t}\n\n\t.uni-textarea-border {\n\t\tpadding: 10px;\n\t\theight: 80px;\n\t}\n\n\t.uni-button-group {\n\t\tmargin-top: 50px;\n\t\t/* #ifndef APP-NVUE */\n\t\tdisplay: flex;\n\t\t/* #endif */\n\t\tjustify-content: center;\n\t}\n\n\t.uni-button {\n\t\twidth: 184px;\n\t\tpadding: 12px 20px;\n\t\tfont-size: 14px;\n\t\tborder-radius: 4px;\n\t\tline-height: 1;\n\t\tmargin: 0;\n\t}\n</style>\n","import MiniProgramPage from 'E:/桌面/创新培育/kite-master/uni_modules/uni-feedback/pages/opendb-feedback/opendb-feedback.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","validator","uniCloud"],"mappings":";;;AA4BCA,cAAA,MAAA,MAAA,OAAA,4EAAYC,wDAAS,SAAA;AACrB,MAAM,KAAKC,iBAAS;AACpB,MAAM,mBAAmB;AAEzB,SAAS,aAAa,QAAQ;AAC7B,MAAI,SAAS,CAAC;AACd,WAAS,OAAOD,mEAAW;AAC1B,QAAI,OAAO,QAAQ,GAAG,IAAI,IAAI;AAC7B,aAAO,GAAG,IAAIA,wDAAS,UAAC,GAAG;AAAA,IAC5B;AAAA,EACD;AACA,SAAO;AACR;AAEA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,QAAI,WAAW;AAAA,MACd,WAAW;AAAA,MACX,QAAQ,CAAE;AAAA,MACV,WAAW;AAAA,MACX,UAAU;AAAA,IACX;AACA,WAAO;AAAA,MACN;AAAA,MACA,aAAa,CAAE;AAAA,MACf,OAAO;AAAA,QACN,GAAG,aAAa,OAAO,KAAK,QAAQ,CAAC;AAAA,MACtC;AAAA,IACD;AAAA,EACA;AAAA,EACD,UAAU;AACT,SAAK,MAAM,KAAK,SAAS,KAAK,KAAK;AAAA,EACnC;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,SAAS;AACRD,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,OACN;AACD,WAAK,MAAM,KAAK,SAAQ,EAAG,KAAK,CAAC,QAAQ;AACxC,aAAK,WAAW,GAAG;AAAA,OACnB,EAAE,MAAM,MAAM;AACdA,sBAAAA,MAAI,YAAY;AAAA,OAChB;AAAA,IACD;AAAA,IAED,WAAW,OAAO;AAEjB,SAAG,WAAW,gBAAgB,EAAE,IAAI,KAAK,EAAE,KAAK,CAAC,QAAQ;AACxDA,sBAAAA,MAAI,UAAU;AAAA,UACb,MAAM;AAAA,UACN,OAAO;AAAA,SACP;AACD,aAAK,sBAAqB,EAAG,KAAK,aAAa;AAC/C,mBAAW,MAAMA,cAAAA,MAAI,aAAY,GAAI,GAAG;AAAA,MACzC,CAAC,EAAE,MAAM,CAAC,QAAQ;AACjBA,sBAAAA,MAAI,UAAU;AAAA,UACb,SAAS,IAAI,WAAW;AAAA,UACxB,YAAY;AAAA,SACZ;AAAA,MACF,CAAC,EAAE,QAAQ,MAAM;AAChBA,sBAAAA,MAAI,YAAY;AAAA,OAChB;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9FD,GAAG,WAAW,eAAe;"}