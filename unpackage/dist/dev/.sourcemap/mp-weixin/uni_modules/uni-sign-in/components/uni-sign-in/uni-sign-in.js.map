{"version":3,"file":"uni-sign-in.js","sources":["uni_modules/uni-sign-in/components/uni-sign-in/uni-sign-in.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTov5qGM6Z2iL-WIm-aWsOWfueiCsi9raXRlLW1hc3Rlci91bmlfbW9kdWxlcy91bmktc2lnbi1pbi9jb21wb25lbnRzL3VuaS1zaWduLWluL3VuaS1zaWduLWluLnZ1ZQ"],"sourcesContent":["<template>\n\t<view>\n\t\t<uni-popup ref=\"popup\" type=\"center\">\n\t\t\t<image class=\"background-img\" src=\"@/uni_modules/uni-sign-in/static/background.png\" mode=\"width\">\n\t\t\t</image>\n\t\t\t<view class=\"content\">\n\t\t\t\t<view class=\"main\">\n\t\t\t\t\t<text class=\"title\">今日签到成功</text>\n\t\t\t\t\t<text class=\"total\">本轮已签到{{signInRes.days.length}}天</text>\n\t\t\t\t\t<text class=\"scores\">当前积分：{{signInRes.score}}</text>\n\t\t\t\t</view>\n\t\t\t\t<view>\n\t\t\t\t\t<view class=\"days-box\">\n\t\t\t\t\t\t<view class=\"days\" v-for=\"(item,index) in weekdays\" :key=\"index\">\n\t\t\t\t\t\t\t<uni-icons v-if=\"signInRes.days.includes(item-1)\" class=\"icon active\" color=\"#FFFFFF\"\n\t\t\t\t\t\t\t\ttype=\"checkmarkempty\"></uni-icons>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<uni-icons v-if=\"item<signInRes.n\" class=\"icon active\" color=\"#FFFFFF\"\n\t\t\t\t\t\t\t\t\ttype=\"closeempty\"></uni-icons>\n\t\t\t\t\t\t\t\t<uni-icons v-else class=\"icon\" type=\"checkmarkempty\" color=\"#FFFFFF\"></uni-icons>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-if=\"signInRes.days.includes(item-1)||item>signInRes.n\">\n\t\t\t\t\t\t\t\t<text class=\"day\" :class=\"{grey:item>signInRes.n}\">第{{item}}天</text>\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<text v-else class=\"day\">缺卡</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"tip-box\">\n\t\t\t\t\t\t<text class=\"tip\">签到一次得10积分</text>\n\t\t\t\t\t\t<view class=\"row\">\n\t\t\t\t\t\t\t<text class=\"tip\">连续签到7天可多得</text>\n\t\t\t\t\t\t\t<text class=\"red\">50</text>\n\t\t\t\t\t\t\t<text class=\"tip\">积分</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<uni-icons @click=\"closeMe\" class=\"close-icon\" type=\"closeempty\" size=\"20\" color=\"#AAAAAA\"></uni-icons>\n\t\t\t</view>\n\t\t</uni-popup>\n\t</view>\n</template>\n\n<script>\n\tconst db = uniCloud.database();\n\tconst signInTable = db.action('signIn').collection('opendb-sign-in')\n\tconst date = new Date(new Date().toLocaleDateString()).getTime()\n\timport AD from \"../../utils/ad.js\"\n\texport default {\n\t\tname: \"uni-signIn\",\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\ttotal: 0,\n\t\t\t\tscores: 0,\n\t\t\t\tweekdays: [1, 2, 3, 4, 5, 6, 7],\n\t\t\t\tsignInRes: {\n\t\t\t\t\tdays: [],\n\t\t\t\t\tn: 0\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tmounted() {},\n\t\tmethods: {\n\t\t\tasync getSignedInInfo(ToastText = '今日已签过') {\n\t\t\t\tconst date = new Date(new Date().toLocaleDateString()).getTime()\n\t\t\t\tlet res = await signInTable\n\t\t\t\t\t.where(`'user_id' == $env.uid && 'date' == ${date} && 'isDelete' == false`)\n\t\t\t\t\t.get()\n\t\t\t\tif (res.result.data.length) {\n\t\t\t\t\tthis.signInRes = res.result\n\t\t\t\t\tthis.$refs.popup.open()\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: ToastText,\n\t\t\t\t\t\tduration: 3000,\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn res.result.data\n\t\t\t},\n\t\t\t//看激励视频广告签到\n\t\t\tasync showRewardedVideoAd() {\n\t\t\t\tlet res = await this.getSignedInInfo();\n\t\t\t\tconsole.log(res);\n\t\t\t\tif (res && res.length == 0) {\n\t\t\t\t\tlet userId= uniCloud.getCurrentUserInfo().uid\n\t\t\t\t\tif (!userId) {\n\t\t\t\t\t\treturn uni.navigateTo({\n\t\t\t\t\t\t\turl: \"/pages/ucenter/login-page/index/index\"\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\t// 调用后会显示 loading 界面\n\t\t\t\t\tAD.show({\n\t\t\t\t\t\tadpid: 1733738477, // HBuilder 基座测试广告位\n\t\t\t\t\t\tadType: \"RewardedVideo\",\n\t\t\t\t\t\turlCallback: {\n\t\t\t\t\t\t\tuserId,\n\t\t\t\t\t\t\textra: 'uniSignIn'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, res => {\n\t\t\t\t\t\t// 用户点击了【关闭广告】按钮\n\t\t\t\t\t\tif (res && res.isEnded) {\n\t\t\t\t\t\t\t// 正常播放结束\n\t\t\t\t\t\t\tconsole.log(\"onClose \" + res.isEnded);\n\t\t\t\t\t\t\t//3次轮训查结果\n\t\t\t\t\t\t\t// uni.showLoading({mask: true});\n\t\t\t\t\t\t\tlet i = 0;\n\t\t\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\t\t\tmask: true\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tlet myIntive = setInterval(async e => {\n\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\tres = await this.getSignedInInfo('签到成功');\n\t\t\t\t\t\t\t\tif (i > 2 || res.length) {\n\t\t\t\t\t\t\t\t\tif (!res.length) {\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\ttitle: '签到失败！',\n\t\t\t\t\t\t\t\t\t\t\ticon: 'error',\n\t\t\t\t\t\t\t\t\t\t\tduration: 6000\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tclearInterval(myIntive)\n\t\t\t\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 播放中途退出\n\t\t\t\t\t\t\tconsole.log(\"onClose \" + res.isEnded);\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '播放中途退出,签到失败！',\n\t\t\t\t\t\t\t\ticon: 'error',\n\t\t\t\t\t\t\t\tduration: 5000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 在此处理服务器回调逻辑\n\t\t\t\t\t}, (err) => {\n\t\t\t\t\t\t// 广告加载错误\n\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: err.errMsg,\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\t\t\t//普通点击签到\n\t\t\tasync open() {\n\t\t\t\tuni.showLoading({\n\t\t\t\t\tmask: true\n\t\t\t\t});\n\t\t\t\ttry {\n\t\t\t\t\tlet res = await this.getSignedInInfo();\n\t\t\t\t\tif (res && res.length == 0) {\n\t\t\t\t\t\tlet res = await signInTable.add({});\n\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\tthis.signInRes = res.result\n\t\t\t\t\t\tthis.$refs.popup.open()\n\t\t\t\t\t\tif (this.signInRes.days.length == 7) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"你已完成7日连续签到，获得60积分！\",\n\t\t\t\t\t\t\t\ticon: \"none\",\n\t\t\t\t\t\t\t\tduration: 5000\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"签到成功,获得10积分！\",\n\t\t\t\t\t\t\t\ticon: \"none\",\n\t\t\t\t\t\t\t\tduration: 5000\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\tconsole.error(e)\n\t\t\t\t}\n\t\t\t},\n\t\t\tcloseMe(e) {\n\t\t\t\tthis.$refs.popup.close()\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\tview {\n\t\tdisplay: flex;\n\t\tbox-sizing: border-box;\n\t\tflex-direction: column;\n\t}\n\n\tscroll-view {\n\t\t-webkit-overflow-scrolling: touch;\n\t}\n\n\t.background-img {\n\t\twidth: 600rpx;\n\t\theight: 600rpx;\n\t}\n\n\t.content {\n\t\tposition: absolute;\n\t\twidth: 600rpx;\n\t\theight: 600rpx;\n\t\tjustify-content: space-around;\n\t\talign-items: center;\n\t\tborder-radius: 10px;\n\t\tz-index: 5;\n\t}\n\n\t.background-img,\n\t.content {\n\t\ttop: 0;\n\t}\n\n\t.main {\n\t\talign-items: center;\n\t}\n\n\t.title {\n\t\tfont-size: 44rpx;\n\t\tcolor: #FFFFFF;\n\t\tfont-weight: 600;\n\t}\n\n\t.total {\n\t\tbackground-color: #FFFFFF;\n\t\tcolor: #ed5200;\n\t\ttext-align: center;\n\t\tborder-radius: 100px;\n\t\tfont-size: 30rpx;\n\t\tmargin: 16rpx 0;\n\t\twidth: 230rpx;\n\t}\n\n\t.scores {\n\t\ttext-align: center;\n\t\tcolor: #FFFFFF;\n\t}\n\n\t.days-box {\n\t\tflex-direction: row;\n\t}\n\n\t.days {\n\t\tmargin: 12rpx;\n\t\tfont-size: 19rpx;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tcolor: #f8692c;\n\t}\n\n\t.grey {\n\t\tcolor: #C0C0C0;\n\t}\n\n\t.days-box .icon {\n\t\tbackground-color: #feefeb;\n\t\tborder-radius: 100px;\n\t\theight: 50rpx;\n\t\tline-height: 50rpx;\n\t\ttext-align: center;\n\t\twidth: 50rpx;\n\t\tmargin-bottom: 6rpx;\n\t}\n\n\t.days-box .icon.active {\n\t\tbackground-image: linear-gradient(to top, #FF9002, #FF5100);\n\t\tbackground-color: #ffff7f;\n\t}\n\n\t.content,\n\t.days-box {\n\t\tpadding: 26rpx;\n\t}\n\n\t.tip-box {\n\t\tjustify-content: center;\n\t}\n\n\t.tip-box .row {\n\t\tflex-direction: row;\n\t\tjustify-content: center;\n\t}\n\n\t.tip,\n\t.red {\n\t\ttext-align: center;\n\t\tfont-size: 24rpx;\n\t\tcolor: #999999;\n\t\theight: 30rpx;\n\t\tline-height: 30rpx;\n\t}\n\n\t.red {\n\t\tcolor: #ff0000;\n\t}\n\n\t.close-icon {\n\t\tmargin-bottom: -180rpx;\n\t\tbackground-color: #FFFFFF;\n\t\tborder-radius: 100px;\n\t\ttext-align: center;\n\t\theight: 46rpx;\n\t\tline-height: 46rpx;\n\t\twidth: 46rpx;\n\t}\n</style>\n","import Component from 'E:/桌面/创新培育/kite-master/uni_modules/uni-sign-in/components/uni-sign-in/uni-sign-in.vue'\nwx.createComponent(Component)"],"names":["uniCloud","uni","AD","res"],"mappings":"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"}